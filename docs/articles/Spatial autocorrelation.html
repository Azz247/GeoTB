<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatial autocorrelation • GeoTB</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spatial autocorrelation">
<meta property="og:description" content="GeoTB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GeoTB</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dashboard
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Dashboard.html">OPD data</a>
    </li>
    <li>
      <a href="../articles/DashboardIPD.html">IPD data</a>
    </li>
    <li>
      <a href="../articles/Summary.html">Summary</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sub-district Map
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Subdistrict_2014-2023.html">Map of tuberculosis patient numbers</a>
    </li>
    <li>
      <a href="../articles/MapOfCIR.html">Map of Crude Incidence Rate</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Spatial Autocorrelation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Spatial%20autocorrelation.html">Overview</a>
    </li>
    <li>
      <a href="../articles/All-Types-of-Tuberculosis.html">All Types of Tuberculosis</a>
    </li>
    <li>
      <a href="../articles/Pulmonary-Tuberculosis.html">Pulmonary Tuberculosis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/Time-series_Map.html">Time-series Map</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spatial autocorrelation</h1>
            
      
      
      <div class="hidden name"><code>Spatial autocorrelation.Rmd</code></div>

    </div>

    
    
<p>ㅤSpatial autocorrelation refers to a clustering pattern in the
spatial distribution of a variable, indicating the extent to which a
variable is spatially correlated with itself. Positive autocorrelation
(or clustering) occurs when neighboring observations are more similar to
each other, while negative autocorrelation (or dispersion) occurs when
neighboring observations tend to differ. This technique can be divided
into two main methods:</p>
<ul>
<li><a href="#global-spatial-autocorrelation">Global Spatial
Autocorrelation</a></li>
<li><a href="#local-spatial-autocorrelation">Local Spatial
Autocorrelation</a></li>
</ul>
<div class="section level2">
<h2 id="spatial-weight">Spatial weight<a class="anchor" aria-label="anchor" href="#spatial-weight"></a>
</h2>
<p>ㅤIn the first step, we identify the spatial weight matrix (W) as a
square binary matrix based on queen contiguity. The concept of queen
contiguity considers adjacent neighbors that mutually share borders and
edges. In this square binary matrix, if units i and j share a border,
the matrix weight (wij) is set to 1; if they do not share a border,
(wij) is set to 0. The diagonal elements of the weight matrix (wii) are
also set to 0. In this study, Spatial weight of 18
locations(sub-district) was evaluated and calculated queen contiguity by
using <code>GeoDa (version 1.22)</code> as presented in the figure
below.</p>
<img src="https://raw.githubusercontent.com/Azz247/GeoTB/main/man/figures/weight%20queen.png" width="80%">
</div>
<div class="section level2">
<h2 id="global-spatial-autocorrelation">Global Spatial Autocorrelation<a class="anchor" aria-label="anchor" href="#global-spatial-autocorrelation"></a>
</h2>
<p>ㅤA global detection technique was used to assess spatial
autocorrelation across the entire study area, providing a single summary
measure that describes the overall degree of spatial association in the
dataset. The Global Moran’s I statistic (Moran, 1950) was used to
calculate the global autocorrelation coefficient. It yields a score
ranging between -1 and 1: a positive score indicates clustering of
similar values, a negative score indicates dispersion of similar values,
and a score close to zero suggests a random spatial distribution</p>
<p>Global Moran’s I statistic equation is <sup><a href="#ref1">1</a></sup>:</p>
<div style="font-family: Arial; font-size: 16px;">
  <br>
    $$I = \frac{n}{S_0} \cdot \frac{\sum_{i=1}^{n} \sum_{j=1}^{n} w_{ij} (x_i - \bar{x})(x_j - \bar{x})}{\sum_{i=1}^{n} (x_i - \bar{x})^2}$$
    <br>
    Where:
    <ul>
<li>\(I\) is the Global Moran’s I for observation \(i\).</li>
      <li>\(n\) is the total number of observations.</li>
      <li>\(x_i\) and \(x_j\) are the values of the variable of interest at locations \(i\) and \(j\).</li>
      <li>\(\bar{x}\) is the mean of the variable of interest.</li>
      <li>\(w_{ij}\) is the spatial weight between locations \(i\) and \(j\).</li>
      <li>\(S_0 = \sum_{i=1}^{n} \sum_{j=1}^{n} w_{ij}\)</li>
      <br>
</ul>
</div>
<p>ㅤInference for Global Moran’s I was based on the null hypothesis of
spatial randomness. The significance of the Global Moran’s I statistic
was evaluated using a permutation test distribution, with 99,999 random
permutations computed using <code>GeoDa (version 1.22)</code>.</p>
</div>
<div class="section level2">
<h2 id="local-spatial-autocorrelation">Local Spatial Autocorrelation<a class="anchor" aria-label="anchor" href="#local-spatial-autocorrelation"></a>
</h2>
<p>ㅤLocal detection focuses on spatial autocorrelation at specific
locations within the study area. The Local Moran’s I statistic was used
to calculate local autocorrelation. A positive Local Moran’s I indicates
a cluster of similar values, while a negative Local Moran’s I indicates
clustering of dissimilar values. If the Local Moran’s I is close to
zero, it suggests that there is no significant spatial clustering at
that location.</p>
<p>Local Moran’s I statistic equation is <sup><a href="#ref1">1</a></sup>:</p>
<div style="font-family: Arial; font-size: 16px;">
  
$$I_i = \frac{\sum_{j=1}^{n} w_{ij} (x_i - \bar{x})(x_j - \bar{x})}{\sum_{i=1}^{n} (x_i - \bar{x})^2}$$
<br>
Where:
<ul>
<li>\(I_i\) is the Local Moran’s I for observation \(i\).</li>
<li>\(x_i\) is the value of the variable of interest at location \(i\).</li>
<li>\(x_j\) is the value of the variable at location \(j\).</li>
<li>\(\bar{x}\) is the mean of the variable of interest.</li>
<li>\(w_{ij}\) is the spatial weight between location \(i\) and location \(j\).</li>
<li>\(\sum_{i=1}^{n} (x_i - \bar{x})^2\) is the total sum of squared deviations from the mean.</li>
<br>
</ul>
</div>
<p>ㅤThe significance of the Local Moran’s I statistic for each spatial
unit was evaluated using a permutation test distribution, with 99,999
random permutations computed using <code>GeoDa (version 1.22)</code>.
This high number of permutations increases the precision of the
significance tests, ensuring more reliable identification of significant
spatial clusters. Results are considered significant when the p-value is
less than 0.05.</p>
</div>
<div class="section level2">
<h2 id="local-indicators-of-spatial-association-lisa">Local Indicators of Spatial Association (LISA)<a class="anchor" aria-label="anchor" href="#local-indicators-of-spatial-association-lisa"></a>
</h2>
<p>ㅤLocal Indicators of Spatial Association (LISA), as described by
Anselin (1995), are used to identify the magnitude of spatial clustering
around specific geographical points or areal units. Each observation
reveals the extent of significant spatial clustering of similar values
in the vicinity of that location. In this study, LISA was utilized to
analyze local spatial autocorrelation, which resulted in four distinct
categories<sup><a href="#ref2">2</a></sup>:</p>
<ul>
<li>High-High Clusters: Areas where high values cluster with other high
values.</li>
<li>Low-Low Clusters: Areas where low values cluster with other low
values.</li>
<li>High-Low Outliers: Areas with high values surrounded by low
values.</li>
<li>Low-High Outliers: Areas with low values surrounded by high
values.</li>
</ul>
<p>ㅤThis classification helps to understand the spatial distribution of
the variable of interest and identify patterns of spatial dependence
within the study area.</p>
<p><mark style="font-size: 16px; background-color : lightblue; ">Moran
scatter plot</mark></p>
<p>ㅤThe Moran scatter plot, introduced by Anselin (1996), plots the
spatially lagged variable on the y-axis and the original variable on the
x-axis. The slope of the linear fit represents Moran’s I. For a variable
<span class="math inline">\(Z\)</span> in deviations from the mean and
row-standardized weights where <span class="math inline">\(S_0\)</span>
equals the number of observations <span class="math inline">\(N\)</span>, Moran’s I simplifies to<sup><a href="#ref3">3</a></sup>:</p>
<div style="font-family: Arial; font-size: 16px;">
<br>
$$I = \frac{\sum_i \sum_j w_{ij} z_i z_j}{\sum_i z_i^2} = \frac{\sum_i (z_i \times \sum_j w_{ij} z_j)}{\sum_i z_i^2}$$
<br>
</div>
<p>In this context, the slope of the regression of <span class="math inline">\(\sum_j w_{ij} z_j\)</span> on <span class="math inline">\(z_i\)</span> represents Moran’s I.</p>
</div>
<div class="section level2">
<h2 id="inference">Inference<a class="anchor" aria-label="anchor" href="#inference"></a>
</h2>
<p><mark style="font-size: 16px; background-color : lightblue; ">Null
hypothesis</mark></p>
<p>ㅤPermutation inference for Moran’s I relies on a null hypothesis of
spatial randomness, with the statistic’s distribution derived either
under the assumption of normality (independent normal random variates)
or randomization (where each value is equally likely at any
location)<sup><a href="#ref3">3</a></sup>.</p>
<p><mark style="font-size: 16px; background-color : lightblue; ">Pseudo
p-value</mark></p>
<p>ㅤThe reference distribution is used to calculate a pseudo p-value
as<sup><a href="#ref3">3</a></sup>:</p>
<div style="font-family: Arial; font-size: 16px;">
  
$$p = \frac{R + 1}{M + 1}$$
Where:
<ul>
<li>\(p\) is the pseudo p-value.</li>
<li>\(R\) is the number of times the computed Moran's I from permuted data is equal to or more extreme than the observed statistic.</li>
<li>\(M\) is the number of permutations.</li>
<br>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<p><a id="ref1"></a>(1) Bivand RS, Wong DW. Comparing implementations of
global and local indicators of spatial association. Test.
2018;27(3):716-48.</p>
<p><a id="ref2"></a>(2) Anselin L. Local indicators of spatial
association—LISA. Geogr Anal. 1995;27(2):93-115</p>
<p><a id="ref3"></a>(3) GeoDa Center for Geospatial Analysis and
Computation. Global Spatial Autocorrelation (Lab 5A). Available at: <a href="https://geodacenter.github.io/workbook/5a_global_auto/lab5a.html" class="external-link uri">https://geodacenter.github.io/workbook/5a_global_auto/lab5a.html</a>.
[Accessed 8 September 2024.]</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Narongsak Ngamchaiyaphum.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
