colours_59  <- colorBin(col_custom1, domain = combine59$count_if, na.color = "transparent", bins = bins)
# Combine58
colours_58  <- colorBin(col_custom1, domain = combine58$count_if, na.color = "transparent", bins = bins)
# Label
popup66 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine66$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine66$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine66$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine66$count_if)
popup66 <- lapply(popup66, HTML)
popup65 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine65$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine65$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine65$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine65$count_if)
popup65 <- lapply(popup65, HTML)
popup64 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine64$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine64$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine64$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine64$count_if)
popup64 <- lapply(popup64, HTML)
popup63 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine63$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine63$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine63$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine63$count_if)
popup63 <- lapply(popup63, HTML)
popup62 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine62$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine62$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine62$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine62$count_if)
popup62 <- lapply(popup62, HTML)
popup61 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine61$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine61$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine61$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine61$count_if)
popup61 <- lapply(popup61, HTML)
popup60 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine60$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine60$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine60$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine60$count_if)
popup60 <- lapply(popup60, HTML)
popup59 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine59$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine59$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine59$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine59$count_if)
popup59 <- lapply(popup59, HTML)
popup58 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine58$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine58$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine58$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine58$count_if)
popup58 <- lapply(popup58, HTML)
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8)%>%
addTiles(group = "Open Street Map")%>%
addPolygons(data = combine63,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_63(combine63$count_if),
color = "white",label = popup63, highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addControl(position = "topright",
html = '<div style="background-color: white; padding: 5px;">ðŸ”½ 2020</div>'))
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8)%>%
addTiles(group = "Open Street Map")%>%
addPolygons(data = combine63,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_63(combine63$count_if),
color = "white",label = popup63, highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addControl(position = "topright",
html = '<div style="background-color: white; padding: 5px;">ðŸ”½ 2020</div>')
paste("Number of patients" "#f5b3bb" = 1-5 ,"#ef8894" = 6-10 ,"#e85767"=11-15,"#dc0018" = 51-200,"#a60013" > 200 ,"#73000d")
library(ggplot2)
library(sf)
library(ggmap)
library(maps)
library(dplyr)
library(sp)
library(tidyverse)
library(readxl)
library(leaflet)
library(htmltools)
library(leaflet.minicharts)
library(manipulateWidget)
# Load shapefiles
thailand_sf <- read_sf("thailand_province_amphoe_tambon_simplify.shp")
SubDistrict66 <- read_excel("Combine66.xlsx")
SubDistrict65 <- read_excel("Combine65.xlsx")
SubDistrict64 <- read_excel("Combine64.xlsx")
SubDistrict63 <- read_excel("Combine63.xlsx")
SubDistrict62 <- read_excel("Combine62.xlsx")
SubDistrict61 <- read_excel("Combine61.xlsx")
SubDistrict60 <- read_excel("Combine60.xlsx")
SubDistrict59 <- read_excel("Combine59.xlsx")
SubDistrict58 <- read_excel("Combine58.xlsx")
combine66 <- left_join(thailand_sf,SubDistrict66, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine65 <- left_join(thailand_sf,SubDistrict65, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine64 <- left_join(thailand_sf,SubDistrict64, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine63 <- left_join(thailand_sf,SubDistrict63, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine62 <- left_join(thailand_sf,SubDistrict62, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine61 <- left_join(thailand_sf,SubDistrict61, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine60 <- left_join(thailand_sf,SubDistrict60, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine59 <- left_join(thailand_sf,SubDistrict59, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine58 <- left_join(thailand_sf,SubDistrict58, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
col_custom1 = c("#f5b3bb","#ef8894","#e85767","#dc0018","#73000d")
bins = c(1,6,11,51,201,Inf)
legend_labels <- c("1-5","6-10","11-50","51-200",">200")
# Combine66
colours_66  <- colorBin(col_custom1, domain = combine66$count_if, na.color = "transparent", bins = bins)
# Combine65
colours_65  <- colorBin(col_custom1, domain = combine65$count_if, na.color = "transparent", bins = bins)
# Combine64
colours_64  <- colorBin(col_custom1, domain = combine64$count_if, na.color = "transparent", bins = bins)
# Combine63
colours_63  <- colorBin(col_custom1, domain = combine63$count_if, na.color = "transparent", bins = bins)
# Combine62
colours_62  <- colorBin(col_custom1, domain = combine62$count_if, na.color = "transparent", bins = bins)
# Combine61
colours_61  <- colorBin(col_custom1, domain = combine61$count_if, na.color = "transparent", bins = bins)
# Combine60
colours_60  <- colorBin(col_custom1, domain = combine60$count_if, na.color = "transparent", bins = bins)
# Combine59
colours_59  <- colorBin(col_custom1, domain = combine59$count_if, na.color = "transparent", bins = bins)
# Combine58
colours_58  <- colorBin(col_custom1, domain = combine58$count_if, na.color = "transparent", bins = bins)
# Label
popup66 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine66$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine66$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine66$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine66$count_if)
popup66 <- lapply(popup66, HTML)
popup65 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine65$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine65$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine65$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine65$count_if)
popup65 <- lapply(popup65, HTML)
popup64 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine64$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine64$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine64$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine64$count_if)
popup64 <- lapply(popup64, HTML)
popup63 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine63$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine63$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine63$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine63$count_if)
popup63 <- lapply(popup63, HTML)
popup62 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine62$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine62$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine62$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine62$count_if)
popup62 <- lapply(popup62, HTML)
popup61 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine61$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine61$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine61$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine61$count_if)
popup61 <- lapply(popup61, HTML)
popup60 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine60$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine60$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine60$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine60$count_if)
popup60 <- lapply(popup60, HTML)
popup59 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine59$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine59$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine59$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine59$count_if)
popup59 <- lapply(popup59, HTML)
popup58 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine58$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine58$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine58$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine58$count_if)
popup58 <- lapply(popup58, HTML)
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8)%>%
addTiles(group = "Open Street Map")%>%
addPolygons(data = combine66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_66(combine66$count_if),
color = "white",label = popup66, highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addControl(position = "topright",
html = '<div style="background-color: white; padding: 5px;">ðŸ”½ 2020</div>')%>%
addLegend(position ="bottomleft",pal = colours_66,labFormat = function(type, cuts, p) { paste0(legend_labels)},
values = combine66$count_if, title = "Number of patients",opacity =1)%>% syncWith("maps")
library(ggplot2)
library(sf)
library(ggmap)
library(maps)
library(dplyr)
library(sp)
library(tidyverse)
library(readxl)
library(leaflet)
library(htmltools)
library(leaflet.minicharts)
library(manipulateWidget)
# Load shapefiles
thailand_sf <- read_sf("thailand_province_amphoe_tambon_simplify.shp")
SubDistrict66 <- read_excel("Combine66.xlsx")
SubDistrict65 <- read_excel("Combine65.xlsx")
SubDistrict64 <- read_excel("Combine64.xlsx")
SubDistrict63 <- read_excel("Combine63.xlsx")
SubDistrict62 <- read_excel("Combine62.xlsx")
SubDistrict61 <- read_excel("Combine61.xlsx")
SubDistrict60 <- read_excel("Combine60.xlsx")
SubDistrict59 <- read_excel("Combine59.xlsx")
SubDistrict58 <- read_excel("Combine58.xlsx")
combine66 <- left_join(thailand_sf,SubDistrict66, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine65 <- left_join(thailand_sf,SubDistrict65, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine64 <- left_join(thailand_sf,SubDistrict64, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine63 <- left_join(thailand_sf,SubDistrict63, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine62 <- left_join(thailand_sf,SubDistrict62, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine61 <- left_join(thailand_sf,SubDistrict61, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine60 <- left_join(thailand_sf,SubDistrict60, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine59 <- left_join(thailand_sf,SubDistrict59, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine58 <- left_join(thailand_sf,SubDistrict58, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
col_custom1 = c("#f5b3bb","#ef8894","#e85767","#dc0018","#a60013","#73000d")
bins = c(1,6,11,51,201,Inf)
legend_labels <- c("1-5","6-10","11-50","51-200",">200")
# Combine66
colours_66  <- colorBin(col_custom1, domain = combine66$count_if, na.color = "transparent", bins = bins)
# Combine65
colours_65  <- colorBin(col_custom1, domain = combine65$count_if, na.color = "transparent", bins = bins)
# Combine64
colours_64  <- colorBin(col_custom1, domain = combine64$count_if, na.color = "transparent", bins = bins)
# Combine63
colours_63  <- colorBin(col_custom1, domain = combine63$count_if, na.color = "transparent", bins = bins)
# Combine62
colours_62  <- colorBin(col_custom1, domain = combine62$count_if, na.color = "transparent", bins = bins)
# Combine61
colours_61  <- colorBin(col_custom1, domain = combine61$count_if, na.color = "transparent", bins = bins)
# Combine60
colours_60  <- colorBin(col_custom1, domain = combine60$count_if, na.color = "transparent", bins = bins)
# Combine59
colours_59  <- colorBin(col_custom1, domain = combine59$count_if, na.color = "transparent", bins = bins)
# Combine58
colours_58  <- colorBin(col_custom1, domain = combine58$count_if, na.color = "transparent", bins = bins)
# Label
popup66 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine66$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine66$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine66$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine66$count_if)
popup66 <- lapply(popup66, HTML)
popup65 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine65$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine65$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine65$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine65$count_if)
popup65 <- lapply(popup65, HTML)
popup64 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine64$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine64$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine64$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine64$count_if)
popup64 <- lapply(popup64, HTML)
popup63 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine63$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine63$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine63$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine63$count_if)
popup63 <- lapply(popup63, HTML)
popup62 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine62$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine62$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine62$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine62$count_if)
popup62 <- lapply(popup62, HTML)
popup61 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine61$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine61$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine61$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine61$count_if)
popup61 <- lapply(popup61, HTML)
popup60 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine60$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine60$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine60$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine60$count_if)
popup60 <- lapply(popup60, HTML)
popup59 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine59$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine59$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine59$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine59$count_if)
popup59 <- lapply(popup59, HTML)
popup58 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine58$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine58$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine58$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine58$count_if)
popup58 <- lapply(popup58, HTML)
HTML('
<div class="legend">
<p><strong>Legend: Number of patients</strong></p>
<ul>
<li><span style="background-color:#f5b3bb;"></span> 1-5</li>
<li><span style="background-color:#ef8894;"></span> 6-10</li>
<li><span style="background-color:#e85767;"></span> 11-50</li>
<li><span style="background-color:#dc0018;"></span> 51-200</li>
<li><span style="background-color:#a60013;"></span> >200</li>
</ul>
</div>
')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px;"><p><strong>Legend: Number of patients</strong></p><ul><li><span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb;"></span> 1-5</li><li><span style="display:inline-block; width:20px; height:10px; background-color:#ef8894;"></span> 6-10</li><li><span style="display:inline-block; width:20px; height:10px; background-color:#e85767;"></span> 11-50</li><li><span style="display:inline-block; width:20px; height:10px; background-color:#dc0018;"></span> 51-200</li><li><span style="display:inline-block; width:20px; height:10px; background-color:#a60013;"></span> >200</li></ul></div>')
library(ggplot2)
library(sf)
library(ggmap)
library(maps)
library(dplyr)
library(sp)
library(tidyverse)
library(readxl)
library(leaflet)
library(htmltools)
library(leaflet.minicharts)
library(manipulateWidget)
library(htmltools)
# Load shapefiles
thailand_sf <- read_sf("thailand_province_amphoe_tambon_simplify.shp")
SubDistrict66 <- read_excel("Combine66.xlsx")
SubDistrict65 <- read_excel("Combine65.xlsx")
SubDistrict64 <- read_excel("Combine64.xlsx")
SubDistrict63 <- read_excel("Combine63.xlsx")
SubDistrict62 <- read_excel("Combine62.xlsx")
SubDistrict61 <- read_excel("Combine61.xlsx")
SubDistrict60 <- read_excel("Combine60.xlsx")
SubDistrict59 <- read_excel("Combine59.xlsx")
SubDistrict58 <- read_excel("Combine58.xlsx")
combine66 <- left_join(thailand_sf,SubDistrict66, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine65 <- left_join(thailand_sf,SubDistrict65, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine64 <- left_join(thailand_sf,SubDistrict64, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine63 <- left_join(thailand_sf,SubDistrict63, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine62 <- left_join(thailand_sf,SubDistrict62, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine61 <- left_join(thailand_sf,SubDistrict61, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine60 <- left_join(thailand_sf,SubDistrict60, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine59 <- left_join(thailand_sf,SubDistrict59, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
combine58 <- left_join(thailand_sf,SubDistrict58, by = c("ADM1_TH"="Unique_province" ,"ADM2_TH" ="Unique_amp","ADM3_TH"="Unique_tambol" ))
col_custom1 = c("#f5b3bb","#ef8894","#e85767","#dc0018","#a60013","#73000d")
bins = c(1,6,11,51,201,Inf)
legend_labels <- c("1-5","6-10","11-50","51-200",">200")
# Combine66
colours_66  <- colorBin(col_custom1, domain = combine66$count_if, na.color = "transparent", bins = bins)
# Combine65
colours_65  <- colorBin(col_custom1, domain = combine65$count_if, na.color = "transparent", bins = bins)
# Combine64
colours_64  <- colorBin(col_custom1, domain = combine64$count_if, na.color = "transparent", bins = bins)
# Combine63
colours_63  <- colorBin(col_custom1, domain = combine63$count_if, na.color = "transparent", bins = bins)
# Combine62
colours_62  <- colorBin(col_custom1, domain = combine62$count_if, na.color = "transparent", bins = bins)
# Combine61
colours_61  <- colorBin(col_custom1, domain = combine61$count_if, na.color = "transparent", bins = bins)
# Combine60
colours_60  <- colorBin(col_custom1, domain = combine60$count_if, na.color = "transparent", bins = bins)
# Combine59
colours_59  <- colorBin(col_custom1, domain = combine59$count_if, na.color = "transparent", bins = bins)
# Combine58
colours_58  <- colorBin(col_custom1, domain = combine58$count_if, na.color = "transparent", bins = bins)
# Label
popup66 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine66$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine66$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine66$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine66$count_if)
popup66 <- lapply(popup66, HTML)
popup65 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine65$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine65$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine65$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine65$count_if)
popup65 <- lapply(popup65, HTML)
popup64 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine64$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine64$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine64$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine64$count_if)
popup64 <- lapply(popup64, HTML)
popup63 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine63$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine63$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine63$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine63$count_if)
popup63 <- lapply(popup63, HTML)
popup62 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine62$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine62$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine62$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine62$count_if)
popup62 <- lapply(popup62, HTML)
popup61 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine61$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine61$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine61$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine61$count_if)
popup61 <- lapply(popup61, HTML)
popup60 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine60$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine60$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine60$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine60$count_if)
popup60 <- lapply(popup60, HTML)
popup59 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine59$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine59$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine59$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine59$count_if)
popup59 <- lapply(popup59, HTML)
popup58 <- paste0("<b>à¸•à¸³à¸šà¸¥:</b> ", combine58$ADM3_TH,
"<br><b>à¸­à¸³à¹€à¸ à¸­:</b> ", combine58$ADM2_TH,
"<br><b>à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”:</b> ", combine58$ADM1_TH,
"<br><b>à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢(à¸„à¸™):</b> ", combine58$count_if)
popup58 <- lapply(popup58, HTML)
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px; display: inline;"><p><strong>Legend: Number of patients</strong></p><ul style="display: inline;"><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb;"></span> 1-5</li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#ef8894;"></span> 6-10</li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#e85767;"></span> 11-50</li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#dc0018;"></span> 51-200</li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#a60013;"></span> >200</li></ul></div>')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px; display: inline;"><p><strong>Legend: Number of patients</strong></p><ul style="display: inline;"><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb;"></span> 1-5  </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#ef8894;"></span> 6-10  </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#e85767;"></span> 11-50  </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#dc0018;"></span> 51-200  </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#a60013;"></span> >200  </li></ul></div>')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px; display: inline;"><p><strong>Legend: Number of patients</strong></p><ul style="display: inline;"><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb;"></span> 1-5    </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#ef8894;"></span> 6-10    </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#e85767;"></span> 11-50    </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#dc0018;"></span> 51-200    </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#a60013;"></span> >200    </li></ul></div>')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px;"><strong style="display: inline;">Legend: Number of patients</strong><ul style="display: inline;"><li><span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb;"></span> 1-5</li><li><span style="display:inline-block; width:20px; height:10px; background-color:#ef8894;"></span> 6-10</li><li><span style="display:inline-block; width:20px; height:10px; background-color:#e85767;"></span> 11-50</li><li><span style="display:inline-block; width:20px; height:10px; background-color:#dc0018;"></span> 51-200</li><li><span style="display:inline-block; width:20px; height:10px; background-color:#a60013;"></span> >200</li></ul></div>')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px; display: inline;"><p><strong>Number of patients</strong></p><ul style="display: inline;"><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb;"></span> 1-5    </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#ef8894;"></span> 6-10    </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#e85767;"></span> 11-50    </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#dc0018;"></span> 51-200    </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#a60013;"></span> >200    </li></ul></div>')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px; display: inline;"><p><strong>Number of patients</strong></p><ul style="display: inline;"><li style="display: inline;"><span style="display:inline; width:20px; height:10px; background-color:#f5b3bb;"></span> 1-5 </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#ef8894;"></span> 6-10 </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#e85767;"></span> 11-50 </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#dc0018;"></span> 51-200 </li><li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#a60013;"></span> >200 </li></ul></div>')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px; display: inline;">
<p><strong>Number of patients</strong></p>
<ul style="display: inline;">
<li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb;"></span> 1-5 </li>
<li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#ef8894;"></span> 6-10 </li>
<li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#e85767;"></span> 11-50 </li>
<li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#dc0018;"></span> 51-200 </li>
<li style="display: inline;"><span style="display:inline-block; width:20px; height:10px; background-color:#a60013;"></span> >200 </li>
</ul>
</div>')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px;">
<p><strong>Number of patients</strong></p>
<ul style="padding: 0;">
<li style="display: inline-block; margin-right: 10px;"><span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb; margin-right: 5px;"></span> 1-5 </li>
<li style="display: inline-block; margin-right: 10px;"><span style="display:inline-block; width:20px; height:10px; background-color:#ef8894; margin-right: 5px;"></span> 6-10 </li>
<li style="display: inline-block; margin-right: 10px;"><span style="display:inline-block; width:20px; height:10px; background-color:#e85767; margin-right: 5px;"></span> 11-50 </li>
<li style="display: inline-block; margin-right: 10px;"><span style="display:inline-block; width:20px; height:10px; background-color:#dc0018; margin-right: 5px;"></span> 51-200 </li>
<li style="display: inline-block;"><span style="display:inline-block; width:20px; height:10px; background-color:#a60013; margin-right: 5px;"></span> >200 </li>
</ul>
</div>')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px;">
<p><strong>Number of patients</strong></p>
<ul style="padding: 0;">
<li style="display: inline-block; margin-right: 20px;"><span style="display: inline-block; width:20px; height:10px; background-color:#f5b3bb; margin-right: 5px; vertical-align: middle;"></span> <span style="vertical-align: middle;">1-5</span> </li>
<li style="display: inline-block; margin-right: 20px;"><span style="display: inline-block; width:20px; height:10px; background-color:#ef8894; margin-right: 5px; vertical-align: middle;"></span> <span style="vertical-align: middle;">6-10</span> </li>
<li style="display: inline-block; margin-right: 20px;"><span style="display: inline-block; width:20px; height:10px; background-color:#e85767; margin-right: 5px; vertical-align: middle;"></span> <span style="vertical-align: middle;">11-50</span> </li>
<li style="display: inline-block; margin-right: 20px;"><span style="display: inline-block; width:20px; height:10px; background-color:#dc0018; margin-right: 5px; vertical-align: middle;"></span> <span style="vertical-align: middle;">51-200</span> </li>
<li style="display: inline-block;"><span style="display: inline-block; width:20px; height:10px; background-color:#a60013; margin-right: 5px; vertical-align: middle;"></span> <span style="vertical-align: middle;">&gt;200</span> </li>
</ul>
</div>')
HTML('<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px; display: inline;">
<p><strong>Number of patients</strong>
<span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb; margin-left: 10px;"></span> 1-5
<span style="display:inline-block; width:20px; height:10px; background-color:#ef8894; margin-left: 10px;"></span> 6-10
<span style="display:inline-block; width:20px; height:10px; background-color:#e85767; margin-left: 10px;"></span> 11-50
<span style="display:inline-block; width:20px; height:10px; background-color:#dc0018; margin-left: 10px;"></span> 51-200
<span style="display:inline-block; width:20px; height:10px; background-color:#a60013; margin-left: 10px;"></span> >200
</p>
</div>')
HTML('<div style="text-align: center;">
<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px; display: inline-block; text-align: left;">
<p><strong>Number of patients</strong>
<span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb; margin-left: 10px;"></span> 1-5
<span style="display:inline-block; width:20px; height:10px; background-color:#ef8894; margin-left: 10px;"></span> 6-10
<span style="display:inline-block; width:20px; height:10px; background-color:#e85767; margin-left: 10px;"></span> 11-50
<span style="display:inline-block; width:20px; height:10px; background-color:#dc0018; margin-left: 10px;"></span> 51-200
<span style="display:inline-block; width:20px; height:10px; background-color:#a60013; margin-left: 10px;"></span> >200
</p>
</div>
</div>
')
HTML('<div style="text-align: center;">
<div class="legend" style="font-family: Arial, sans-serif; font-size: 14px; display: inline-block; text-align: left;">
<p><strong>Number of patients</strong>
<span style="display:inline-block; width:20px; height:10px; background-color:#f5b3bb; margin-left: 10px;"></span> 1-5
<span style="display:inline-block; width:20px; height:10px; background-color:#ef8894; margin-left: 10px;"></span> 6-10
<span style="display:inline-block; width:20px; height:10px; background-color:#e85767; margin-left: 10px;"></span> 11-50
<span style="display:inline-block; width:20px; height:10px; background-color:#dc0018; margin-left: 10px;"></span> 51-200
<span style="display:inline-block; width:20px; height:10px; background-color:#a60013; margin-left: 10px;"></span> >200
</p>
</div>
</div>
')
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "95%"
)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "95%"
)
devtools::build_readme()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
devtools::build_readme()
devtools::build_readme()
htmltools::HTML('<style>
.dashboard {
position: fixed;
left: 0;
top: 50px;
bottom: 0;
right: 0;
}
.dashboard iframe {
width: 100%;
height: 100%;
border: none;
}
</style>
<div class="dashboard">
<iframe src="https://azz247.github.io/GeoTB/root/Time-seriesMap_OPD_KK.html">
</iframe>
</div>')
pkgdown::build_site()
