overlayGroups = c("OPD_2565","IPD_2565"),
options = layersControlOptions(collapsed = FALSE)
)
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 5)%>%
addTiles(group = "Open Street Map") %>%
addPolygons(data = KK_contry, label = KK_contry$TA,weight = 0.5, fillOpacity = 0,
group = "KhonKean_subdistrict", color = "black")%>%
addCircleMarkers(data = coordinates_sf64, popup = popup_content64,
radius = 4,color = c("black"),fillColor = "red" ,fillOpacity = 0.9,weight = 1,group = "OPD_2564")%>%
addCircleMarkers(data = coordinates_sfIPD64, popup = popup_contentIPD64,
radius = 5,color = c("black"),fillColor = "blue" ,fillOpacity = 0.9,weight = 1, group = "IPD_2564")%>%
hideGroup("IPD_2564") %>%
addMeasure(
position = "bottomleft",
primaryLengthUnit = "meters",
secondaryLengthUnit = "kilometers",
primaryAreaUnit = "sqmeters",
activeColor = "#3D535D",
completedColor = "#7D4479")%>%
addMiniMap(toggleDisplay = TRUE)%>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2564","IPD_2564"),
options = layersControlOptions(collapsed = FALSE)
)
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 5)%>%
addTiles(group = "Open Street Map") %>%
addPolygons(data = KK_contry, label = KK_contry$TA,weight = 0.5, fillOpacity = 0,
group = "KhonKean_subdistrict", color = "black")%>%
addCircleMarkers(data = coordinates_sf63, popup = popup_content63,
radius = 4,color = c("black"),fillColor = "red" ,fillOpacity = 0.9,weight = 1,group = "OPD_2563")%>%
addCircleMarkers(data = coordinates_sfIPD63, popup = popup_contentIPD63,
radius = 5,color = c("black"),fillColor = "blue" ,fillOpacity = 0.9,weight = 1, group = "IPD_2563")%>%
hideGroup("IPD_2563") %>%
addMeasure(
position = "bottomleft",
primaryLengthUnit = "meters",
secondaryLengthUnit = "kilometers",
primaryAreaUnit = "sqmeters",
activeColor = "#3D535D",
completedColor = "#7D4479")%>%
addMiniMap(toggleDisplay = TRUE)%>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2563","IPD_2563"),
options = layersControlOptions(collapsed = FALSE)
)
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 5)%>%
addTiles(group = "Open Street Map") %>%
addPolygons(data = KK_contry, label = KK_contry$TA,weight = 0.5, fillOpacity = 0,
group = "KhonKean_subdistrict", color = "black")%>%
addCircleMarkers(data = coordinates_sf62, popup = popup_content62,
radius = 4,color = c("black"),fillColor = "red" ,fillOpacity = 0.9,weight = 1,group = "OPD_2562")%>%
addCircleMarkers(data = coordinates_sfIPD62, popup = popup_contentIPD62,
radius = 5,color = c("black"),fillColor = "blue" ,fillOpacity = 0.9,weight = 1, group = "IPD_2562")%>%
hideGroup("IPD_2562") %>%
addMeasure(
position = "bottomleft",
primaryLengthUnit = "meters",
secondaryLengthUnit = "kilometers",
primaryAreaUnit = "sqmeters",
activeColor = "#3D535D",
completedColor = "#7D4479")%>%
addMiniMap(toggleDisplay = TRUE)%>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2562","IPD_2562"),
options = layersControlOptions(collapsed = FALSE)
)
setwd("D:/My_Research/GgPlot")
library(ggplot2)
library(sf)
library(ggmap)
library(maps)
library(dplyr)
library(sp)
library(readxl)
library(leaflet)
# Load shapefiles
thailand_sf <- read_sf("thailand_province_amphoe_tambon_simplify.shp")
thailand_Amp$AP <- str_c(thailand_Amp$NL_NAME_2,' | ',thailand_Amp$NL_NAME_1)
library(terra)
thailand_Amp$AP <- str_c(thailand_Amp$NL_NAME_2,' | ',thailand_Amp$NL_NAME_1)
library(tidyverse)
thailand_Amp$AP <- str_c(thailand_Amp$NL_NAME_2,' | ',thailand_Amp$NL_NAME_1)
# Set polygon label
thailand_Amp$AP <- str_c(thailand_Amp$NL_NAME_2,' | ',thailand_Amp$NL_NAME_1)
# Load shapefiles
thailand_Amp <- read_sf("thailand_province_amphoe_tambon_simplify.shp")
thailand_Amp$AP <- str_c(thailand_Amp$NL_NAME_2,' | ',thailand_Amp$NL_NAME_1)
combined_data$TAP <- str_c(combined_data$ADM3_TH,' | ',combined_data$ADM2_TH,' | ',combined_data$ADM1_TH)
View(thailand_Amp)
View(thailand_Amp)
View(thailand_Amp)
# Load shapefiles
thailand_sf <- read_sf("thailand_province_amphoe_tambon_simplify.shp")
setwd("D:/My_Research/GgPlot")
library(ggplot2)
library(sf)
library(ggmap)
library(maps)
library(dplyr)
library(sp)
library(tidyverse)
library(readxl)
library(leaflet)
# Load shapefiles
thailand_sf <- read_sf("thailand_province_amphoe_tambon_simplify.shp")
OPD66 <- read_excel("SubDistrictOPD66.xlsx")
OPD65 <- read_excel("SubDistrictOPD65.xlsx")
OPD64 <- read_excel("SubDistrictOPD64.xlsx")
OPD63 <- read_excel("SubDistrictOPD63.xlsx")
OPD62 <- read_excel("SubDistrictOPD62.xlsx")
IPD66 <- read_excel("SubDistrictIPD66.xlsx")
IPD65 <- read_excel("SubDistrictIPD65.xlsx")
IPD64 <- read_excel("SubDistrictIPD64.xlsx")
IPD63 <- read_excel("SubDistrictIPD63.xlsx")
IPD62 <- read_excel("SubDistrictIPD62.xlsx")
combined_OPD66 <- left_join(thailand_sf,OPD66, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_OPD65 <- left_join(thailand_sf,OPD65, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_OPD64 <- left_join(thailand_sf,OPD64, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_OPD63 <- left_join(thailand_sf,OPD63, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_OPD62 <- left_join(thailand_sf,OPD62, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD66 <- left_join(thailand_sf,IPD66, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD65 <- left_join(thailand_sf,IPD65, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD64 <- left_join(thailand_sf,IPD64, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD63 <- left_join(thailand_sf,IPD63, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD62 <- left_join(thailand_sf,IPD62, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
col_custom1 = c("#f5b3bb","#ef8894","#e85767","#dc0018","#a60013","#73000d")
col_custom2 = c("skyblue1","steelblue2","royalblue3","blue","darkblue","midnightblue")
bins = c(1,6,11,51,201,1000)
legend_labels <- c("1-5","6-10","11-50","51-200",">200")
# OPD 66
colours_OPD66  <- colorBin(col_custom1, domain = combined_OPD66$N_Count, na.color = "transparent", bins = bins)
# OPD 65
colours_OPD65  <- colorBin(col_custom1, domain = combined_OPD65$N_Count, na.color = "transparent", bins = bins)
# OPD 64
colours_OPD64  <- colorBin(col_custom1, domain = combined_OPD64$N_Count, na.color = "transparent", bins = bins)
# OPD 63
colours_OPD63  <- colorBin(col_custom1, domain = combined_OPD63$N_Count, na.color = "transparent", bins = bins)
# OPD 62
colours_OPD62  <- colorBin(col_custom1, domain = combined_OPD62$N_Count, na.color = "transparent", bins = bins)
# IPD 66
colours_IPD66  <- colorBin(col_custom2, domain = combined_IPD66$N_Count, na.color = "transparent", bins = bins)
# IPD 65
colours_IPD65  <- colorBin(col_custom2, domain = combined_IPD65$N_Count, na.color = "transparent", bins = bins)
# IPD 64
colours_IPD64  <- colorBin(col_custom2, domain = combined_IPD64$N_Count, na.color = "transparent", bins = bins)
# IPD 63
colours_IPD63  <- colorBin(col_custom2, domain = combined_IPD63$N_Count, na.color = "transparent", bins = bins)
# IPD 62
colours_IPD62  <- colorBin(col_custom2, domain = combined_IPD62$N_Count, na.color = "transparent", bins = bins)
# pop_up
popupOPD66 <- paste0("<b>จังหวัด:</b> ", combined_OPD66$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD66$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD66$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD66$N_Count)
popupOPD65 <- paste0("<b>จังหวัด:</b> ", combined_OPD65$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD65$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD65$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD65$N_Count)
popupOPD64 <- paste0("<b>จังหวัด:</b> ", combined_OPD64$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD64$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD64$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD64$N_Count)
popupOPD63 <- paste0("<b>จังหวัด:</b> ", combined_OPD63$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD63$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD63$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD63$N_Count)
popupOPD62 <- paste0("<b>จังหวัด:</b> ", combined_OPD62$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD62$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD62$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD62$N_Count)
popupIPD66 <- paste0("<b>จังหวัด:</b> ", combined_IPD66$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD66$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD66$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD66$N_Count)
popupIPD65 <- paste0("<b>จังหวัด:</b> ", combined_IPD65$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD65$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD65$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD65$N_Count)
popupIPD64 <- paste0("<b>จังหวัด:</b> ", combined_IPD64$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD64$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD64$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD64$N_Count)
popupIPD63 <- paste0("<b>จังหวัด:</b> ", combined_IPD63$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD63$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD63$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD63$N_Count)
popupIPD62 <- paste0("<b>จังหวัด:</b> ", combined_IPD62$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD62$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD62$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD62$N_Count)
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8)%>%
addTiles(group = "Open Street Map")%>%
addPolygons(data = combined_OPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_OPD66(combined_OPD66$N_Count),
color = "white",popup = popupOPD66,group = "OPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addPolygons(data = combined_IPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_IPD66(combined_IPD66$N_Count),
color = "white",popup = popupIPD66,group = "IPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addLegend(position ="bottomleft",pal = colours_OPD66,
values = combined_OPD66$N_Count, title = "Number of patients(OPD)",opacity =1,group = "OPD_2566")%>%
addLegend(position ="bottomleft",pal = colours_IPD66,
values = combined_IPD66$N_Count, title = "Number of patients(IPD)",opacity =1,group = "IPD_2566")%>%
addMiniMap(toggleDisplay = TRUE)%>%
hideGroup("IPD_2566") %>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2566","IPD_2566"),
options = layersControlOptions(collapsed = FALSE)
)
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8)%>%
addTiles(group = "Open Street Map")%>%
addPolygons(data = combined_OPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_OPD66(combined_OPD66$N_Count),
color = "white",popup = popupOPD66,group = "OPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addPolygons(data = combined_IPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_IPD66(combined_IPD66$N_Count),
color = "white",popup = popupIPD66,group = "IPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addLegend(position ="bottomleft",pal = colours_OPD66,labels = c("legend_labels"),
values = combined_OPD66$N_Count, title = "Number of patients(OPD)",opacity =1,group = "OPD_2566")%>%
addLegend(position ="bottomleft",pal = colours_IPD66,labels = c("legend_labels"),
values = combined_IPD66$N_Count, title = "Number of patients(IPD)",opacity =1,group = "IPD_2566")%>%
addMiniMap(toggleDisplay = TRUE)%>%
hideGroup("IPD_2566") %>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2566","IPD_2566"),
options = layersControlOptions(collapsed = FALSE)
)
# Run Leaflet 66
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8) %>%
addTiles(group = "Open Street Map") %>%
addPolygons(data = combined_OPD66, weight = 0.35, opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_OPD66(combined_OPD66$N_Count),
color = "white", popup = popupOPD66, group = "OPD_2566",
highlightOptions = highlightOptions(color = "black", weight = 1.5, bringToFront = TRUE)) %>%
addPolygons(data = combined_IPD66, weight = 0.35, opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_IPD66(combined_IPD66$N_Count),
color = "white", popup = popupIPD66, group = "IPD_2566",
highlightOptions = highlightOptions(color = "black", weight = 1.5, bringToFront = TRUE)) %>%
addLegend(position = "bottomleft", pal = colours_OPD66, labels = legend_labels,
values = combined_OPD66$N_Count, title = "Number of patients(OPD)",
opacity = 1, group = "OPD_2566") %>%
addLegend(position = "bottomleft", pal = colours_IPD66, labels = legend_labels,
values = combined_IPD66$N_Count, title = "Number of patients(IPD)",
opacity = 1, group = "IPD_2566") %>%
addMiniMap(toggleDisplay = TRUE) %>%
hideGroup("IPD_2566") %>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2566", "IPD_2566"),
options = layersControlOptions(collapsed = FALSE)
)
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8)%>%
addTiles(group = "Open Street Map")%>%
addPolygons(data = combined_OPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_OPD66(combined_OPD66$N_Count),
color = "white",popup = popupOPD66,group = "OPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addPolygons(data = combined_IPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_IPD66(combined_IPD66$N_Count),
color = "white",popup = popupIPD66,group = "IPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addLegend(position ="bottomleft",pal = colours_OPD66, labels = legend_labels,
values = combined_OPD66$N_Count, title = "Number of patients(OPD)",opacity =1,group = "OPD_2566")%>%
addLegend(position ="bottomleft",pal = colours_IPD66,labels = legend_labels,
values = combined_IPD66$N_Count, title = "Number of patients(IPD)",opacity =1,group = "IPD_2566")%>%
addMiniMap(toggleDisplay = TRUE)%>%
hideGroup("IPD_2566") %>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2566","IPD_2566"),
options = layersControlOptions(collapsed = FALSE)
)
?addLegend
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8)%>%
addTiles(group = "Open Street Map")%>%
addPolygons(data = combined_OPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_OPD66(combined_OPD66$N_Count),
color = "white",popup = popupOPD66,group = "OPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addPolygons(data = combined_IPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_IPD66(combined_IPD66$N_Count),
color = "white",popup = popupIPD66,group = "IPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addLegend(position ="bottomleft",pal = colours_OPD66, labels = legend_labels,
values = combined_OPD66$N_Count, title = "Number of patients(OPD)",opacity =1,group = "OPD_2566")%>%
addLegend(position ="bottomleft",pal = colours_IPD66,labels = legend_labels,
values = combined_IPD66$N_Count, title = "Number of patients(IPD)",opacity =1,group = "IPD_2566")%>%
addMiniMap(toggleDisplay = TRUE)%>%
hideGroup("IPD_2566") %>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2566","IPD_2566"),
options = layersControlOptions(collapsed = FALSE)
)
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8) %>%
addTiles(group = "Open Street Map") %>%
addPolygons(data = combined_OPD66, weight = 0.35, opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colorNumeric(palette = col_custom1, domain = combined_OPD66$N_Count, bins = bins),
color = "white", popup = popupOPD66, group = "OPD_2566",
highlightOptions = highlightOptions(color = "black", weight = 1.5, bringToFront = TRUE)) %>%
addPolygons(data = combined_IPD66, weight = 0.35, opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colorNumeric(palette = col_custom2, domain = combined_IPD66$N_Count, bins = bins),
color = "white", popup = popupIPD66, group = "IPD_2566",
highlightOptions = highlightOptions(color = "black", weight = 1.5, bringToFront = TRUE)) %>%
addLegend(position = "bottomleft", pal = col_custom1, labels = legend_labels,
values = combined_OPD66$N_Count, title = "Number of patients(OPD)",
opacity = 1, group = "OPD_2566") %>%
addLegend(position = "bottomleft", pal = col_custom2, labels = legend_labels,
values = combined_IPD66$N_Count, title = "Number of patients(IPD)",
opacity = 1, group = "IPD_2566") %>%
addMiniMap(toggleDisplay = TRUE) %>%
hideGroup("IPD_2566") %>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2566", "IPD_2566"),
options = layersControlOptions(collapsed = FALSE)
)
# Run Leaflet 66
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8) %>%
addTiles(group = "Open Street Map") %>%
addPolygons(data = combined_OPD66, weight = 0.35, opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colorNumeric(palette = col_custom1, domain = combined_OPD66$N_Count[!is.na(combined_OPD66$N_Count) & combined_OPD66$N_Count > 0], bins = bins),
color = "white", popup = popupOPD66, group = "OPD_2566",
highlightOptions = highlightOptions(color = "black", weight = 1.5, bringToFront = TRUE)) %>%
addPolygons(data = combined_IPD66, weight = 0.35, opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colorNumeric(palette = col_custom2, domain = combined_IPD66$N_Count[!is.na(combined_IPD66$N_Count) & combined_IPD66$N_Count > 0], bins = bins),
color = "white", popup = popupIPD66, group = "IPD_2566",
highlightOptions = highlightOptions(color = "black", weight = 1.5, bringToFront = TRUE)) %>%
addLegend(position = "bottomleft", pal = col_custom1, labels = legend_labels,
values = combined_OPD66$N_Count, title = "Number of patients(OPD)",
opacity = 1, group = "OPD_2566") %>%
addLegend(position = "bottomleft", pal = col_custom2, labels = legend_labels,
values = combined_IPD66$N_Count, title = "Number of patients(IPD)",
opacity = 1, group = "IPD_2566") %>%
addMiniMap(toggleDisplay = TRUE) %>%
hideGroup("IPD_2566") %>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2566", "IPD_2566"),
options = layersControlOptions(collapsed = FALSE)
)
bins = c(1,5,10,50,200,500)
legend_labels <- c("1-5","6-10","11-50","51-200",">200")
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8)%>%
addTiles(group = "Open Street Map")%>%
addPolygons(data = combined_OPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_OPD66(combined_OPD66$N_Count),
color = "white",popup = popupOPD66,group = "OPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addPolygons(data = combined_IPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_IPD66(combined_IPD66$N_Count),
color = "white",popup = popupIPD66,group = "IPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addLegend(position ="bottomleft",pal = colours_OPD66, labels = legend_labels,
values = combined_OPD66$N_Count, title = "Number of patients(OPD)",opacity =1,group = "OPD_2566")%>%
addLegend(position ="bottomleft",pal = colours_IPD66,labels = legend_labels,
values = combined_IPD66$N_Count, title = "Number of patients(IPD)",opacity =1,group = "IPD_2566")%>%
addMiniMap(toggleDisplay = TRUE)%>%
hideGroup("IPD_2566") %>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2566","IPD_2566"),
options = layersControlOptions(collapsed = FALSE)
)
library(ggplot2)
library(sf)
library(ggmap)
library(maps)
library(dplyr)
library(sp)
library(tidyverse)
library(readxl)
library(leaflet)
setwd("D:/My_Research/GgPlot")
# Load shapefiles
thailand_sf <- read_sf("thailand_province_amphoe_tambon_simplify.shp")
OPD66 <- read_excel("SubDistrictOPD66.xlsx")
OPD65 <- read_excel("SubDistrictOPD65.xlsx")
OPD64 <- read_excel("SubDistrictOPD64.xlsx")
OPD63 <- read_excel("SubDistrictOPD63.xlsx")
OPD62 <- read_excel("SubDistrictOPD62.xlsx")
IPD66 <- read_excel("SubDistrictIPD66.xlsx")
IPD65 <- read_excel("SubDistrictIPD65.xlsx")
IPD64 <- read_excel("SubDistrictIPD64.xlsx")
IPD63 <- read_excel("SubDistrictIPD63.xlsx")
IPD62 <- read_excel("SubDistrictIPD62.xlsx")
combined_OPD66 <- left_join(thailand_sf,OPD66, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_OPD65 <- left_join(thailand_sf,OPD65, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_OPD64 <- left_join(thailand_sf,OPD64, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_OPD63 <- left_join(thailand_sf,OPD63, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_OPD62 <- left_join(thailand_sf,OPD62, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD66 <- left_join(thailand_sf,IPD66, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD65 <- left_join(thailand_sf,IPD65, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD64 <- left_join(thailand_sf,IPD64, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD63 <- left_join(thailand_sf,IPD63, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
combined_IPD62 <- left_join(thailand_sf,IPD62, by = c("ADM1_TH"="Province" ,"ADM2_TH" ="Amp","ADM3_TH"="Tambol" ))
# OPD 66
colours_OPD66  <- colorBin(col_custom1, domain = combined_OPD66$N_Count, na.color = "transparent", bins = bins, labels = legend_labels)
col_custom1 = c("#f5b3bb","#ef8894","#e85767","#dc0018","#a60013","#73000d")
col_custom2 = c("skyblue1","steelblue2","royalblue3","blue","darkblue","midnightblue")
bins = c(1,6,11,51,201,1000)
legend_labels <- c("1-5","6-10","11-50","51-200",">200")
colours_OPD66 <- colorBin(palette = col_custom1, domain = combined_OPD66$N_Count, bins = bins, na.color = "transparent")
colours_OPD66$setDomain(bins, legend_labels)
?colorBin
leaflet() %>%
setView(lng = 102.825, lat = 16.444, zoom = 8)%>%
addTiles(group = "Open Street Map")%>%
addPolygons(data = combined_OPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_OPD66(combined_OPD66$N_Count),
color = "white",popup = popupOPD66,group = "OPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addPolygons(data = combined_IPD66,weight = 0.35,opacity = 0.7,
fillOpacity = 0.75, fillColor = ~colours_IPD66(combined_IPD66$N_Count),
color = "white",popup = popupIPD66,group = "IPD_2566",highlightOptions = highlightOptions(color = "black",weight = 1.5,bringToFront = TRUE))%>%
addLegend(position = "bottomleft", pal = colours_OPD66,
values = combined_OPD66$N_Count, title = "Number of patients(OPD)",
opacity = 1, group = "OPD_2566", labels = legend_labels) %>%
addLegend(position = "bottomleft", pal = colours_IPD66,
values = combined_IPD66$N_Count, title = "Number of patients(IPD)",
opacity = 1, group = "IPD_2566", labels = legend_labels) %>%
addMiniMap(toggleDisplay = TRUE)%>%
hideGroup("IPD_2566") %>%
addLayersControl(
baseGroups = c("Open Street Map"),
overlayGroups = c("OPD_2566","IPD_2566"),
options = layersControlOptions(collapsed = FALSE)
)
colours_OPD66  <- colorBin(col_custom1, domain = combined_OPD66$N_Count, na.color = "transparent", bins = bins)
# OPD 65
colours_OPD65  <- colorBin(col_custom1, domain = combined_OPD65$N_Count, na.color = "transparent", bins = bins)
# OPD 64
colours_OPD64  <- colorBin(col_custom1, domain = combined_OPD64$N_Count, na.color = "transparent", bins = bins)
# OPD 63
colours_OPD63  <- colorBin(col_custom1, domain = combined_OPD63$N_Count, na.color = "transparent", bins = bins)
# OPD 62
colours_OPD62  <- colorBin(col_custom1, domain = combined_OPD62$N_Count, na.color = "transparent", bins = bins)
# IPD 66
colours_IPD66  <- colorBin(col_custom2, domain = combined_IPD66$N_Count, na.color = "transparent", bins = bins)
# IPD 65
colours_IPD65  <- colorBin(col_custom2, domain = combined_IPD65$N_Count, na.color = "transparent", bins = bins)
# IPD 64
colours_IPD64  <- colorBin(col_custom2, domain = combined_IPD64$N_Count, na.color = "transparent", bins = bins)
# IPD 63
colours_IPD63  <- colorBin(col_custom2, domain = combined_IPD63$N_Count, na.color = "transparent", bins = bins)
# IPD 62
colours_IPD62  <- colorBin(col_custom2, domain = combined_IPD62$N_Count, na.color = "transparent", bins = bins)
popupOPD66 <- paste0("<b>จังหวัด:</b> ", combined_OPD66$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD66$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD66$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD66$N_Count)
popupOPD65 <- paste0("<b>จังหวัด:</b> ", combined_OPD65$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD65$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD65$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD65$N_Count)
popupOPD64 <- paste0("<b>จังหวัด:</b> ", combined_OPD64$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD64$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD64$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD64$N_Count)
popupOPD63 <- paste0("<b>จังหวัด:</b> ", combined_OPD63$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD63$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD63$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD63$N_Count)
popupOPD62 <- paste0("<b>จังหวัด:</b> ", combined_OPD62$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_OPD62$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_OPD62$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_OPD62$N_Count)
popupIPD66 <- paste0("<b>จังหวัด:</b> ", combined_IPD66$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD66$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD66$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD66$N_Count)
popupIPD65 <- paste0("<b>จังหวัด:</b> ", combined_IPD65$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD65$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD65$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD65$N_Count)
popupIPD64 <- paste0("<b>จังหวัด:</b> ", combined_IPD64$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD64$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD64$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD64$N_Count)
popupIPD63 <- paste0("<b>จังหวัด:</b> ", combined_IPD63$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD63$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD63$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD63$N_Count)
popupIPD62 <- paste0("<b>จังหวัด:</b> ", combined_IPD62$ADM1_TH,
"<br><b>อำเภอ:</b> ", combined_IPD62$ADM2_TH,
"<br><b>ตำบล:</b> ", combined_IPD62$ADM3_TH,
"<br><b>จำนวนผู้ป่วย(คน):</b> ", combined_IPD62$N_Count
leaflet() %>%
setwd("D:/My_Research/GgPlot")
library(ggplot2)
library(sf)
library(ggmap)
library(maps)
library(dplyr)
library(sp)
library(tidyverse)
library(readxl)
library(leaflet)
library(tidyverse)
# Load shapefiles
thailand_Village_sf <- read_sf("TH_Village.shp")
setwd("D:/My_Research/GgPlot")
# Load shapefiles
thailand_Village_sf <- read_sf("TH_Village.shp")
