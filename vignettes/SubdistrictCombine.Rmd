---
title: "Spatial autocorrelation"
output: 
  html_document:
    code_folding: hide
    toc: false
    theme: default
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

- [Spatial weight](#spatial-weight)
- [Global Spatial Autocorrelation](#global-spatial-autocorrelation)
- [Local Spatial Autocorrelation](#local-spatial-autocorrelation)

Spatial autocorrelation refers to a clustering pattern in the spatial distribution of a variable, indicating the extent to which a variable is spatially correlated with itself. Positive autocorrelation (or clustering) occurs when neighboring observations are more similar to each other, while negative autocorrelation (or dispersion) occurs when neighboring observations tend to differ. This technique can be divided into two main methods
- Global spatial autocorrelation
- Local spatial autocorrelation

## Spatial weight
In the first step, we identify the spatial weight matrix (W) as a square binary matrix based on queen contiguity. The concept of queen contiguity considers adjacent neighbors that mutually share borders and edges. In this square binary matrix, if units i and j share a border, the matrix weight (wij) is set to 1; if they do not share a border, (wij) is set to 0. The diagonal elements of the weight matrix (wii) are also set to 0. In this study, Spatial weight of 18 locations(sub-district) was evaluated and calculated queen contiguity by using `GeoDa (version 1.22)` as represented

```{r,echo=FALSE}
htmltools::HTML('<img src="https://raw.githubusercontent.com/Azz247/GeoTB/main/man/figures/weight%20queen.png" width="80%" />')
```

## Global Spatial Autocorrelation
A global detection technique was used to assess spatial autocorrelation across the entire study area, providing a single summary measure that describes the overall degree of spatial association in the dataset. The Global Moran’s I statistic (Moran, 1950) was used to calculate the global autocorrelation coefficient.15. It yields a score ranging between -1 and 1: a positive score indicates clustering of similar values, a negative score indicates dispersion of similar values, and a score close to zero suggests a random spatial distribution

```{r,echo=FALSE}
htmltools::HTML('<img src="https://raw.githubusercontent.com/Azz247/GeoTB/main/man/figures/GlobalMoran.png" width="65%" />')
```

Inference for Global Moran’s I was based on the null hypothesis of spatial randomness. The significance of the Global Moran’s I statistic was evaluated using a permutation test distribution20, with 99,999 random permutations computed using `GeoDa (version 1.22)`. 	

## Local Spatial Autocorrelation
Local detection focuses on spatial autocorrelation at specific locations within the study area. The Local Moran’s I statistic was used to calculate local autocorrelation. A positive Local Moran’s I indicates a cluster of similar values, while a negative Local Moran’s I indicates clustering of dissimilar values. If the Local Moran’s I is close to zero, it suggests that there is no significant spatial clustering at that location.

```{r,echo=FALSE}
htmltools::HTML('<img src="https://raw.githubusercontent.com/Azz247/GeoTB/main/man/figures/LocalMoran.png" width="65%" />')
```

The significance of the Local Moran’s I statistic for each spatial unit was evaluated using a permutation test distribution, with 99,999 random permutations computed using `GeoDa (version 1.22)`. This high number of permutations increases the precision of the significance tests, ensuring more reliable identification of significant spatial clusters. Results are considered significant when the p-value is less than 0.05.

Local Indicators of Spatial Association (LISA) statistical measures are used to identify the magnitude of spatial clustering around specific geographical points or areal units. Each observation indicates the extent of significant spatial clustering of similar values around that location. In this study, LISA was used to analyze local spatial autocorrelation, resulting in four distinct categories:
- High-High cluster
- High-Low outlier
- Low-Low cluster
- Low-High outlier
